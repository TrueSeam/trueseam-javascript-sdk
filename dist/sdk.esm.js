class e{constructor(e){this.element=e,this.listeners=[]}addEventListener(e,t,o){this.element.addEventListener(e,t,o),this.listeners.push({type:e,listener:t,options:o})}attachTo(t){t instanceof e?t.element.appendChild(this.element):t.appendChild(this.element),this.onAttached()}detach(){this.element.remove()}destroy(){for(this.detach();this.listeners.length>0;){const{type:e,listener:t,options:o}=this.listeners.pop();this.element.removeEventListener(e,t,o)}}}class t extends e{constructor({animationDefinition:e,element:t}){var o,n;super(t);const i={...e.options,duration:null!==(n=null===(o=e.options)||void 0===o?void 0:o.duration)&&void 0!==n?n:1e3},s=new KeyframeEffect(this.element,e.keyFrames,i);this.animation=new Animation(s)}onAttached(){this.animate()}animate(){this.animation.play()}}class o extends e{constructor({element:e}){super(e)}onAttached(){}}const n="http://localhost:3000";class i extends e{constructor({element:e,onClose:t}){super(e),this.handleClosePopup=t,this.handleMessage=this.onMessage.bind(this),window.addEventListener("message",this.handleMessage)}onMessage(e){e.origin===n&&"CLOSE"===e.data.type&&this.handleClosePopup()}onLoaded(){var e;null===(e=this.element.contentWindow)||void 0===e||e.postMessage({type:"SETUP"},n)}onAttached(){this.element.onload=this.onLoaded.bind(this)}destroy(){window.removeEventListener("message",this.handleMessage)}}function s(e,t){Object.assign(e.style,t)}class r{constructor(){this.containerElement=function(){const e=document.createElement("div");return e.id="cozyhome-container",s(e,{position:"fixed",inset:"0",zIndex:"2147483647",display:"flex",justifyContent:"center",alignItems:"center"}),new o({element:e})}(),this.backdropElement=function(e){const t=document.createElement("div");t.id="cozyhome-backdrop",s(t,{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(2px)",zIndex:"0"});const n=new o({element:t});return n.addEventListener("click",e),n}(this.closePopup.bind(this)),this.frameElement=function(){const e=document.createElement("div");return e.id="cozyhome-frame",s(e,{width:"800px",height:"0px",background:"black",zIndex:"1",borderRadius:"12px",borderTop:"3px solid black",borderBottom:"3px solid black",overflow:"hidden",position:"relative"}),new t({element:e,animationDefinition:{keyFrames:[{width:"0px",height:"0px",borderTop:"3px solid black",borderBottom:"3px solid black"},{width:"800px",height:"0px",offset:.5,borderTop:"3px solid black",borderBottom:"3px solid black"},{width:"800px",height:"600px",offset:1,borderTop:"0px",borderBottom:"0px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)"}],options:{fill:"forwards",easing:"ease-in-out"}}})}(),this.frameContent=function(e){const t=document.createElement("iframe");return t.id="cozyhome-content",t.src="http://localhost:3000/embed",s(t,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",boxSizing:"border-box",color:"white",border:"none"}),new i({element:t,onClose:e})}(this.closePopup.bind(this)),this.frameContent.attachTo(this.frameElement)}openPopup(){this.containerElement.attachTo(document.body),this.backdropElement.attachTo(this.containerElement),this.frameElement.attachTo(this.containerElement);const e=document.body;this.previousBodyOverflow=e.style.overflow,e.style.overflow="hidden"}closePopup(){this.frameElement.detach(),this.backdropElement.detach(),this.containerElement.detach(),void 0!==this.previousBodyOverflow?(document.body.style.overflow=this.previousBodyOverflow,this.previousBodyOverflow=void 0):document.body.style.overflow=""}destroy(){this.frameElement.destroy(),this.backdropElement.destroy(),this.containerElement.destroy()}}class a{constructor(){this.clientToken=null,this.init=e=>{this.clientToken=e.clientToken},this.open=()=>{this.overlayManager.openPopup()},this.close=()=>{this.overlayManager.closePopup()},this.overlayManager=new r}}window.CozyHome=new a;export{a as CozyHome};
//# sourceMappingURL=sdk.esm.js.map
